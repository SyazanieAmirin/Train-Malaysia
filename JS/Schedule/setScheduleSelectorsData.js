const scheduleSectionUlFrom=document.getElementById('main-content-schedule-selector-ul');const scheduleSectionfromTitleFrom=document.getElementById('main-content-schedule-selector-from-title');const scheduleSectionUlTo=document.getElementById('main-content-schedule-selector-ul-to');const scheduleSectionfromTitleTo=document.getElementById('main-content-schedule-selector-to-title');let liElementsFrom=[],liElementsTo=[];let selectedFromStation='',selectedToStation='';const scheduleTableContainer=document.getElementsByClassName("main-content-schedule-table-container")[0];let batuCavesPulauSebangLineStations=['Batu Caves','Taman Wahyu','Kampung Batu','Batu Kentonmen','Sentul','Putra','Bank Negara','Kuala Lumpur','KL Sentral','MidValley','Seputeh','Salak Selatan','Bandar Tasek Selatan','Serdang','Kajang','Kajang 2','UKM','Bangi','Batang Benar','Nilai','Labu','Tiroi','Seremban','Senawang','Sungai Gadut','Rembau','Pulau Sebang / Tampin'];let batuCavesPulauSebangLineStationsSorted=[...batuCavesPulauSebangLineStations].sort();scheduleSectionUlFrom.innerHTML='';scheduleSectionUlTo.innerHTML='';function fillInDataForScheduleBatuCavesPulauSebangLine(){batuCavesPulauSebangLineStationsSorted.forEach(station=>{let liFrom=document.createElement('li');liFrom.textContent=station;liFrom.classList.add('selector-items','header-language-selector-items-li');scheduleSectionUlFrom.appendChild(liFrom);liFrom.addEventListener('click',function(){scheduleSectionfromTitleFrom.textContent=this.textContent;selectedFromStation=this.textContent;if(weekTypeVariable==="Weekday"){console.log("From Station Name: "+selectedFromStation);if(selectedFromStation!==''&&selectedToStation!==''){let fromStation=batuCavesPulauSebangLineStations.indexOf(selectedFromStation);let toStation=batuCavesPulauSebangLineStations.indexOf(selectedToStation);if(fromStation<toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Batu_Caves_Pulau_Sebang','Weekday',selectedFromStation,selectedToStation)}else if(fromStation>toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Pulau_Sebang_Batu_Caves','Weekday',selectedFromStation,selectedToStation)}}else{console.log("Please select both stations.")}}else if(weekTypeVariable==="Weekend"){if(selectedFromStation!==''&&selectedToStation!==''){let fromStation=batuCavesPulauSebangLineStations.indexOf(selectedFromStation);let toStation=batuCavesPulauSebangLineStations.indexOf(selectedToStation);if(fromStation<toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Batu_Caves_Pulau_Sebang','Weekend',selectedFromStation,selectedToStation)}else if(fromStation>toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Pulau_Sebang_Batu_Caves','Weekend',selectedFromStation,selectedToStation)}}else{console.log("Please select both stations.")}}});liElementsFrom.push(liFrom);let liTo=document.createElement('li');liTo.textContent=station;liTo.classList.add('selector-items','header-language-selector-items-li');scheduleSectionUlTo.appendChild(liTo);liTo.addEventListener('click',function(){scheduleSectionfromTitleTo.textContent=this.textContent;selectedToStation=this.textContent;if(weekTypeVariable==="Weekday"){if(selectedFromStation!==''&&selectedToStation!==''){let fromStation=batuCavesPulauSebangLineStations.indexOf(selectedFromStation);let toStation=batuCavesPulauSebangLineStations.indexOf(selectedToStation);console.log("From Station Index: "+fromStation+" To Station Index: "+toStation);if(fromStation<toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Batu_Caves_Pulau_Sebang','Weekday',selectedFromStation,selectedToStation)}else if(fromStation>toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Pulau_Sebang_Batu_Caves','Weekday',selectedFromStation,selectedToStation)}}else{}}else if(weekTypeVariable==="Weekend"){if(selectedFromStation!==''&&selectedToStation!==''){let fromStation=batuCavesPulauSebangLineStations.indexOf(selectedFromStation);let toStation=batuCavesPulauSebangLineStations.indexOf(selectedToStation);if(fromStation<toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Batu_Caves_Pulau_Sebang','Weekend',selectedFromStation,selectedToStation)}else if(fromStation>toStation){getFromToTimeForSchedule('Batu_Caves_Pulau_Sebang_Line','Pulau_Sebang_Batu_Caves','Weekend',selectedFromStation,selectedToStation)}}}});liElementsTo.push(liTo)})}
function deleteAllScheduleLiItems(lineName){liElementsFrom.forEach(li=>{li.remove()});liElementsTo.forEach(li=>{li.remove()});if(lineName==="Batu Caves - Pulau Sebang Line"){selectedFromStation='';selectedToStation='';scheduleSectionfromTitleFrom.textContent='Choose Your Starting Station';scheduleSectionfromTitleTo.textContent='Choose Your Destination Station';scheduleTableContainer.style.display='none'}else if(lineName==="Tanjung Malim - Port Klang Line"){selectedFromStation='';selectedToStation='';scheduleSectionfromTitleFrom.textContent='Choose Your Starting Station';scheduleSectionfromTitleTo.textContent='Choose Your Destination Station';scheduleTableContainer.style.display='none'}
document.getElementsByClassName("main-content-schedule-container")[0].style.marginBottom='13em'}
function getFromToTimeForSchedule(folder,line,weekType,fromStation,toStation){fetch(`JSON/KTM_${folder}/${line}_${weekType}.json`).then(response=>response.json()).then(data=>{let fromTimeArray=[];let toTimeArray=[];console.log(`JSON/KTM_${folder}/${line}_${weekType}.json`);if(data[fromStation]&&data[toStation]){for(const trainnumber in data[fromStation]){if(data[fromStation].hasOwnProperty(trainnumber)){fromTimeArray.push({trainnumber,departure:data[fromStation][trainnumber]})}}
for(const trainnumber in data[toStation]){if(data[toStation].hasOwnProperty(trainnumber)){toTimeArray.push({trainnumber,arrival:data[toStation][trainnumber]})}}
scheduleTableContainer.style.display='flex';updateScheduleTable(fromTimeArray,toTimeArray);document.getElementsByClassName("main-content-schedule-container")[0].style.marginBottom='2em'}else{console.log("Selected stations not found in the JSON data.")}})}
function updateScheduleTable(fromData,toData){let tbody=document.getElementById('main-content-schedule-departure-arrival-table');tbody.innerHTML='';fromData.forEach(item=>{let row=document.createElement('tr');let trainNumberCell=document.createElement('td');trainNumberCell.textContent=item.trainnumber;row.appendChild(trainNumberCell);let departureCell=document.createElement('td');departureCell.textContent=item.departure;row.appendChild(departureCell);let correspondingToData=toData.find(toItem=>toItem.trainnumber===item.trainnumber);if(correspondingToData){let arrivalCell=document.createElement('td');arrivalCell.textContent=correspondingToData.arrival;row.appendChild(arrivalCell)}else{let arrivalCell=document.createElement('td');row.appendChild(arrivalCell)}
tbody.appendChild(row)})}
addEventListener('keydown',function(e){if(e.key==='e'){console.log("Stations From: "+selectedFromStation);console.log("Stations To: "+selectedToStation);console.log("Week Type: "+weekTypeVariable);console.log("Selected From: "+selectedFromStation+" Selected To: "+selectedToStation)}})